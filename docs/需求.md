# solararc-pro

项目名称：SolarArc Pro —— 高性能城市时空日照分析与视觉仿真平台

1. 高精度空间逻辑（科学性增强）
   天文级太阳算法：不再使用简单的三角函数，而是引入 SPA (Solar Position Algorithm)。
   Python 实现：利用 pvlib 或 astral 库，考虑大气折射、地轴倾角及公转轨道离心率。
   精度要求：支持输入全球任意经纬度、日期及特定时区（处理夏令时），计算误差控制在角度秒级。
   投影几何算法（Shadow Volume）：
   实现从 3D 建筑顶点到平面的斜射投影计算。
   复杂形状处理：支持非矩形的复杂多边形（凹多边形）阴影推导，并处理阴影在不同海拔（Z轴）的重叠。
2. 深度 MySQL 架构（后端工程增强）
   空间索引优化：
   使用 MySQL 8.0 的 SRID 4326 (WGS 84) 存储建筑底面 POLYGON。
   建立 SPATIAL INDEX，实现基于当前视野范围（Bounding Box）的动态加载（LOD），确保只查询屏幕内可见的建筑。
   日照元数据管理：
   存储建筑的 Floor_Area、Total_Height、Reflective_Rate（反射率）等属性。
   设计“预计算表”：针对春分、夏至、秋分、冬至四个关键节点，预存每小时的太阳方位数据，减少实时计算压力。
3. 复杂业务逻辑（应用价值增强）
   “有效日照”时长统计：
   用户可点击地图上任意一点，系统通过 Python 后端回溯该点在过去 12 小时内被遮挡的频次，计算出“有效采光时长”。
   阴影重叠分析（Inter-Shadow Analysis）：
   区分建筑的“自阴影”与“投射阴影”。
   计算两个建筑之间阴影的交集面积，用于评估新建建筑对既有社区的采光权侵犯。
   极端气象节点对比：
   支持一键对比“冬至日”（一年中阴影最长）与“夏至日”的阴影范围，为城市规划提供极限参考。
4. 高级 React 交互与渲染（前端性能增强）
   高性能渲染引擎：
   使用 Deck.gl 的 TripsLayer 或自定义 MeshLayer 渲染 3D 建筑。
   Shadow Mapping 技术：利用 WebGL 着色器（Shader）实现实时的光影渲染，而不是简单的平面图形叠加。
   交互式组件：
   24小时时间轴：React 实现平滑的逐帧动画，支持倍速播放（如 10秒 走完 24小时）。
   实时仪表盘：显示当前太阳高度角、方位角、即时阴影长度系数。
   多维度切换：支持“地图模式”（Mapbox/Google Maps 底图）与“白模模式”（专注于阴影对比）。
5. 质量保证与非功能性需求（系统健壮性）
   响应式性能：
   后端：Python FastAPI 开启异步支持，大规模几何运算使用 Numpy 向量化处理。
   前端：数据传输采用二进制或压缩的 GeoJSON，首屏 1000 个建筑载入速度 < 1.5s。
   数据一致性：
   处理建筑底面坐标的共边问题，防止在 3D 渲染时出现闪烁（Z-fighting）。
   坐标系精准映射：
   确保后端计算的投影坐标与前端地图底图坐标完全对齐（处理 Web Mercator 与 WGS84 的转换误差）。

   高质量技术栈推荐 (High-Quality Stack)
   前端：React 18 + typescript + antdesign + Vite + Mapbox GL JS v3 + Shadcn UI (仪表盘界面) + 明暗主题色。
   后端：Python 3.10+ + FastAPI (高性能异步) + shapely (空间计算) + pvlib (太阳位置算法)。
   数据库：MySQL 8.0+ (InnoDB 引擎 + Spatial Index)。
   协议：使用压缩 GeoJSON 优化地理数据传输。
